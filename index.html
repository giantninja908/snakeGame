<!DOCTYPE html>
<html>
  <head>
    <title>Page Title</title>
  </head>
  <body>
    <center>
      <canvas id="canvas" width="500" height="500" style="border:1px solid black"/>
    </center>
    <script>
      var auto = false
      var rot = 90
      var plrX = 0
      var plrY = 0
      var tailX = []
      var tailY = []
      var right = true
      var count = 0
      var menu = true
      var down = false
      var tailLength = 1
      var highscore = tailLength-1
      var canvas = document.getElementById("canvas")
      var ctx = canvas.getContext("2d")
      ctx.font = "50px Ariel"
      var width
      var height
      var sizingVar
      height = window.innerHeight
      width = window.innerWidth
      ctx.clearRect(0, 0, width, height)

      if (width < height) {
        sizingVar = width / 500
      } else {
        sizingVar = height / 500
      }
      canvas.width = sizingVar * 500
      canvas.height = sizingVar * 500
      var rX = Math.floor(Math.random()*50)*10
      var rY = Math.floor(Math.random()*50)*10
      setInterval(function(){
        height = window.innerHeight
        width = window.innerWidth
        ctx.clearRect(0, 0, width, height)

        if (width < height) {
          sizingVar = width / 500
        } else {
          sizingVar = height / 500
        }
        canvas.width = sizingVar * 500
        canvas.height = sizingVar * 500
        ctx.font = (sizingVar*50).toString()+"px Ariel"
        if(menu){
          ctx.fillStyle="black"
          ctx.fillText("Highscore: "+(highscore).toString(),0,250)
          ctx.fillText("Click to start",130*sizingVar,100*sizingVar)
        }else{
        ctx.fillStyle="black"
          ctx.fillRect(plrX*sizingVar,plrY*sizingVar,10*sizingVar,10*sizingVar)
        for(var i= 0;i<tailLength;i++){
          ctx.fillRect(tailX[i]*sizingVar,tailY[i]*sizingVar,10*sizingVar,10*sizingVar)
        }
        ctx.fillStyle="red"
          ctx.fillRect(rX*sizingVar,rY*sizingVar,10*sizingVar,10*sizingVar)
        if(rot == 0){
          plrY -= 10
        }
        if(rot == 180){
          plrY +=10
        }
        if(rot == 90){
          plrX += 10
        }
        if(rot == 270){
          plrX -=10
        }
        if(plrX < 0){
          plrX = 500*sizingVar
        }
        if(plrY < 0){
          plrY = 500*sizingVar
        }
        if(plrX > 500*sizingVar){
          plrX = 0
        }
        if(plrY > 500*sizingVar){
          plrY = 0
        }
        if(plrX == rX && plrY == rY){
          rX = Math.floor(Math.random()*50)*10
          rY = Math.floor(Math.random()*50)*10
          tailX[tailLength] = plrX
          tailY[tailLength] = plrY
          tailLength++
        }
        for(var i=tailLength-1;i>-1;i--){
          if(i == 0){
            tailX[i] = plrX
            tailY[i] = plrY
          }else{
            tailX[i] = tailX[i-1]
            tailY[i] = tailY[i-1]
          }
          if(tailX[i]==plrX&&tailY[i]==plrY&& i!=0){
            if(tailLength-1>highscore){
              highscore = tailLength-1
            }
            
            for(var i = tailLength; i>0;i--){
              tailX.pop()
              tailY.pop()
              //lols
              //lols
            }
            tailLength =0
            menu = true
            
          }
        }
        //rot)
         
        }
        //(plrX)
        // (plrY)
      },100)
      document.onmousedown = function(){
        if(menu){
        menu = false
          plrX =0
          plrY =0
          rot = 90
        }
        
      }
      document.onkeydown = function(e){
        e=e||window.event
        //e.keyCode)
        var res = String.fromCharCode(e.keyCode)
        if(res == "W"){
          rot = 0
          //rot)
        }
        if(res == "D"){
          rot = 90
          //rot)
        }
        if(res == "S"){
          rot = 180
          //rot)
        }
        if(res == "A"){
          rot = 270
          //rot)
        }
        
        
      }
      document.addEventListener('touchstart', handleTouchStart, false);        
      document.addEventListener('touchmove', handleTouchMove, false);

      var xDown = null;                                                        
      var yDown = null;                                                        

      function handleTouchStart(evt) {                                         
        xDown = evt.touches[0].clientX;                                      
        yDown = evt.touches[0].clientY;
        if(menu){
          menu = false
          plrX =0
          plrY =0
          rot = 90
        }
      };                                                

      function handleTouchMove(evt) {
        if ( ! xDown || ! yDown ) {
          return;
        }

        var xUp = evt.touches[0].clientX;                                    
        var yUp = evt.touches[0].clientY;

        var xDiff = xDown - xUp;
        var yDiff = yDown - yUp;

        if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {/*most significant*/
          if ( xDiff > 0 ) {
            /* left swipe */
            rot = 270
          } else {
            /* right swipe */
            rot = 90
          }                       
        } else {
          if ( yDiff > 0 ) {
            /* up swipe */ 
            rot = 0
          } else { 
            /* down swipe */
            rot = 180
          }                                                                 
        }
        /* reset values */
        xDown = null;
        yDown = null;                                             
      };
    </script>
  </body>
</html>
